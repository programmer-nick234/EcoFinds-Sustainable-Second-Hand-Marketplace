module.exports=[85364,a=>{"use strict";a.s(["default",()=>g],85364);var b=a.i(46959);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g}},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},67956,(a,b,c)=>{"use strict";b.exports=a.r(43747).vendored.contexts.AppRouterContext},30940,(a,b,c)=>{"use strict";b.exports=a.r(43747).vendored.contexts.HooksClientContext},35174,(a,b,c)=>{"use strict";b.exports=a.r(43747).vendored.contexts.ServerInsertedHtml},93496,(a,b,c)=>{"use strict";b.exports=a.r(43747).vendored["react-ssr"].ReactServerDOMTurbopackClient},91775,(a,b,c)=>{"use strict";b.exports=a.r(43747).vendored["react-ssr"].ReactDOM},47606,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"HandleISRError",{enumerable:!0,get:function(){return e}});let d=a.r(56704).workAsyncStorage;function e(a){let{error:b}=a;if(d){let a=d.getStore();if((null==a?void 0:a.isRevalidate)||(null==a?void 0:a.isStaticGeneration))throw console.error(b),b}return null}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},6758,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return g}});let d=a.r(5247),e=a.r(47606),f={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"}},g=function(a){let{error:b}=a,c=null==b?void 0:b.digest;return(0,d.jsxs)("html",{id:"__next_error__",children:[(0,d.jsx)("head",{}),(0,d.jsxs)("body",{children:[(0,d.jsx)(e.HandleISRError,{error:b}),(0,d.jsx)("div",{style:f.error,children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("h2",{style:f.text,children:["Application error: a ",c?"server":"client","-side exception has occurred while loading ",window.location.hostname," (see the"," ",c?"server logs":"browser console"," for more information)."]}),c?(0,d.jsx)("p",{style:f.text,children:"Digest: "+c}):null]})})]})]})};("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},50142,a=>{"use strict";a.s(["ArrowLeft",()=>b],50142);let b=(0,a.i(85364).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},96559,a=>{"use strict";a.s(["getImageUrl",()=>c,"productsService",()=>d]);var b=a.i(61844);let c=a=>a?a.startsWith("http")?a:`http://localhost:8000${a}`:"",d={async getProducts(a){try{let c=new URLSearchParams;a&&Object.entries(a).forEach(([a,b])=>{null!=b&&""!==b&&c.append(a,b.toString())});let d=(await b.default.get(`/products/?${c.toString()}`)).data;return Array.isArray(d)?d:d.results||[]}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to fetch products")||"Failed to fetch products")}},async searchProducts(a){try{let c=new URLSearchParams;return Object.entries(a).forEach(([a,b])=>{null!=b&&""!==b&&c.append(a,b.toString())}),(await b.default.get(`/products/search/?${c.toString()}`)).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to search products")||"Failed to search products")}},async getProduct(a){try{return(await b.default.get(`/products/${a}/`)).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to fetch product")||"Failed to fetch product")}},async createProduct(a){try{let c=new FormData;return c.append("title",a.title),c.append("description",a.description),c.append("category",a.category),c.append("price",a.price.toString()),a.image&&c.append("image",a.image),void 0!==a.is_available&&c.append("is_available",a.is_available.toString()),(await b.default.post("/products/",c)).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to create product")||"Failed to create product")}},async updateProduct(a,c){try{let d=new FormData;return c.title&&d.append("title",c.title),c.description&&d.append("description",c.description),c.category&&d.append("category",c.category),void 0!==c.price&&d.append("price",c.price.toString()),c.image&&d.append("image",c.image),void 0!==c.is_available&&d.append("is_available",c.is_available.toString()),(await b.default.patch(`/products/${a}/`,d)).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to update product")||"Failed to update product")}},async deleteProduct(a){try{await b.default.delete(`/products/${a}/`)}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to delete product")||"Failed to delete product")}},async toggleProductAvailability(a){try{return(await b.default.post(`/products/${a}/toggle-availability/`)).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to toggle product availability")||"Failed to toggle product availability")}},async getUserProducts(){try{let a=(await b.default.get("/products/my-products/")).data;return Array.isArray(a)?a:a.results||[]}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to fetch user products")||"Failed to fetch user products")}},async getCategories(){try{return(await b.default.get("/products/categories/")).data}catch(a){throw Error((a&&"object"==typeof a&&"response"in a?a.response?.data?.detail||a.message:"Failed to fetch categories")||"Failed to fetch categories")}}}},58099,a=>{"use strict";a.s(["X",()=>b],58099);let b=(0,a.i(85364).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},50536,a=>{"use strict";a.s(["CheckCircle",()=>b],50536);let b=(0,a.i(85364).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},50384,(a,b,c)=>{b.exports=a.r(52450)},85763,a=>{"use strict";a.s(["AlertCircle",()=>b],85763);let b=(0,a.i(85364).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},26600,a=>{"use strict";a.s(["default",()=>f]);var b=a.i(5247),c=a.i(46959),d=a.i(50384),e=a.i(24163);function f({children:a,redirectTo:f="/login",requireAuth:g=!0}){let{isAuthenticated:h,loading:i}=(0,e.useAuth)(),j=(0,d.useRouter)();return((0,c.useEffect)(()=>{i||(g&&!h?j.push(f):!g&&h&&j.push("/landing"))},[h,i,g,f,j]),i)?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):g&&!h||!g&&h?null:(0,b.jsx)(b.Fragment,{children:a})}},46604,a=>{"use strict";a.s(["Save",()=>b],46604);let b=(0,a.i(85364).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},68564,a=>{"use strict";a.s(["Upload",()=>b],68564);let b=(0,a.i(85364).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},57425,a=>{"use strict";a.s(["default",()=>s]);var b=a.i(5247),c=a.i(46959),d=a.i(50384),e=a.i(95184),f=a.i(16742),g=a.i(2250),h=a.i(24163),i=a.i(26600),j=a.i(96559),k=a.i(68564),l=a.i(58099),m=a.i(46604),n=a.i(50142),o=a.i(85763),p=a.i(50536),q=a.i(32408);let r=g.z.object({title:g.z.string().min(1,"Title is required").max(200,"Title must be less than 200 characters"),description:g.z.string().min(10,"Description must be at least 10 characters").max(1e3,"Description must be less than 1000 characters"),category:g.z.string().min(1,"Category is required"),price:g.z.string().min(1,"Price is required").refine(a=>!isNaN(Number(a))&&Number(a)>0,"Price must be a positive number")});function s({params:a}){let[g,s]=(0,c.useState)(null),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),{user:H,isAuthenticated:I}=(0,h.useAuth)(),J=(0,d.useRouter)(),K=(0,c.use)(a),{register:L,handleSubmit:M,formState:{errors:N},setValue:O,reset:P}=(0,e.useForm)({resolver:(0,f.zodResolver)(r)});(0,c.useEffect)(()=>{let a=async()=>{try{let[a,b]=await Promise.all([j.productsService.getCategories(),j.productsService.getProduct(parseInt(K.id))]);if(u(a),b.owner!==H?.id)return void E("You do not have permission to edit this product");s(b),P({title:b.title,description:b.description,category:b.category,price:b.price}),b.image&&y((0,j.getImageUrl)(b.image))}catch(a){E("Failed to load product data")}finally{A(!1)}};I&&H&&a()},[K.id,I,H,P]);let Q=async a=>{C(!0),E(""),G("");try{let b={title:a.title,description:a.description,category:a.category,price:parseFloat(a.price),image:v||void 0};await j.productsService.updateProduct(parseInt(K.id),b),G("Product updated successfully!"),setTimeout(()=>{J.push("/products/my-products")},2e3)}catch(a){E(a instanceof Error?a.message:"Failed to update product. Please try again.")}finally{C(!1)}};return I?z?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading product..."})]})}):D&&!g?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:D}),(0,b.jsx)(q.default,{href:"/products",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Back to Products"})]})}):(0,b.jsx)(i.default,{children:(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(q.default,{href:"/products/my-products",className:"inline-flex items-center text-green-600 hover:text-green-700 mb-4",children:[(0,b.jsx)(n.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to My Products"]}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Product"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Update your product information"})]}),(0,b.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,b.jsxs)("form",{onSubmit:M(Q),className:"space-y-6",children:[F&&(0,b.jsxs)("div",{className:"bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-md flex items-center",children:[(0,b.jsx)(p.CheckCircle,{className:"h-5 w-5 mr-2"}),F]}),D&&(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md flex items-center",children:[(0,b.jsx)(o.AlertCircle,{className:"h-5 w-5 mr-2"}),D]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Title *"}),(0,b.jsx)("input",{...L("title"),type:"text",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${N.title?"border-red-300":"border-gray-300"}`,placeholder:"Enter product title"}),N.title&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.title.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),(0,b.jsxs)("select",{...L("category"),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${N.category?"border-red-300":"border-gray-300"}`,children:[(0,b.jsx)("option",{value:"",children:"Select a category"}),t.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),N.category&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.category.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price ($) *"}),(0,b.jsx)("input",{...L("price"),type:"number",step:"0.01",min:"0",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${N.price?"border-red-300":"border-gray-300"}`,placeholder:"0.00"}),N.price&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.price.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,b.jsx)("textarea",{...L("description"),rows:4,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${N.description?"border-red-300":"border-gray-300"}`,placeholder:"Describe your product in detail..."}),N.description&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:N.description.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Image"}),x?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:x,alt:"Preview",className:"w-full h-64 object-cover rounded-lg"}),(0,b.jsx)("button",{type:"button",onClick:()=>{w(null),y("")},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:(0,b.jsx)(l.X,{className:"h-4 w-4"})})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){w(b);let a=new FileReader;a.onload=a=>{y(a.target?.result)},a.readAsDataURL(b)}},className:"hidden",id:"image-upload"}),(0,b.jsxs)("label",{htmlFor:"image-upload",className:"cursor-pointer flex flex-col items-center",children:[(0,b.jsx)(k.Upload,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("span",{className:"text-gray-600",children:"Click to upload a new image"}),(0,b.jsx)("span",{className:"text-sm text-gray-500 mt-1",children:"PNG, JPG up to 10MB"})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,b.jsx)(q.default,{href:"/products/my-products",className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,b.jsxs)("button",{type:"submit",disabled:B,className:"flex items-center px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50",children:[(0,b.jsx)(m.Save,{className:"h-4 w-4 mr-2"}),B?"Saving...":"Save Changes"]})]})]})})]})})}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Authentication Required"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Please log in to edit products."}),(0,b.jsx)(q.default,{href:"/login",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Login"})]})})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__c6a16628._.js.map